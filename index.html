<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="style.css">
	<title>Swap Tokens</title>
</head>
<body>
	<h1>swap tokens</h1>
	<label for="fromToken">From Token:</label>
	<select id="fromToken">
		<option value="0x02f0826ef6aD107Cfc861152B32B52fD11BaB9ED">WSGB</option>
		<option value="0xd27EE5DfE38662E93eB92F630F514b4B09aa6a27">TTK</option>
	</select>
	<br>
	<label for="toToken">To Token:</label>
	<select id="toToken">
		<option value="0x02f0826ef6aD107Cfc861152B32B52fD11BaB9ED">WSGB</option>
		<option value="0xd27EE5DfE38662E93eB92F630F514b4B09aa6a27">Ttk</option>
	</select>
	<br>
	<label for="amount">Amount:</label>
	<input type="number" id="amount" name="amount" min="0" step="any">
	<br>
	<button onclick="swap()">Swap</button>
    <br>
    <br>
    <div id="balance"></div>
	<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
	<script>
async function connect() {
    if (window.ethereum) {
        try {
            await window.ethereum.enable();
            const web3 = new Web3(window.ethereum);
            const accounts = await web3.eth.getAccounts();
            const balance = await web3.eth.getBalance(accounts[0]);
            document.getElementById("balance").innerHTML = "Balance: " + balance / 1e18 + " SGB";
        } catch (error) {
            console.error(error);
        }
    } else {
        console.error("MetaMask not detected.");
    }
}

async function swap() {
    const fromToken = document.getElementById("fromToken").value;
    const toToken = document.getElementById("toToken").value;
    const amount = document.getElementById("amount").value;

    const contractAddress = "0x3c5B82e99de08BEca60f53393a856836F3909162";
    const contractAbi = [
        {
            "inputs": [
                {
                    "internalType": "address",
                    "name": "fromToken",
                    "type": "address"
                },
                {
                    "internalType": "address",
                    "name": "toToken",
                    "type": "address"
                },
                {
                    "internalType": "uint256",
                    "name": "amount",
                    "type": "uint256"
                }
            ],
            "name": "swap",
            "outputs": [],
            "stateMutability": "nonpayable",
            "type": "function"
        }
    ];

    const web3 = new Web3(window.ethereum);
    const contract = new web3.eth.Contract(contractAbi, contractAddress);
    const accounts = await web3.eth.getAccounts();
    await contract.methods.swap(fromToken, toToken, amount).send({ from: accounts[0] });
}

connect();

	</script>
</body>
</html>
